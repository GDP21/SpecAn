# MCP load script generated by mcpal  4.11.0


# Program specific load parameters

elf = "mcpImageDemod.elf"
AmemBase = 0x00000000
BmemBase = 0x00000000
LmemBase = 0x00017000
# Standard script to load one MCP program onto the first MCP in a UCCP320 system
from CSUtils import DA

MEMTYPE_PERIPH=10
MCP_MEM_REMAP_B_CTRL = 0x0009
UCC_GLOBAL_RAM_MCP1_REGION_L_BASE = 0x3A08
UCC_GLOBAL_RAM_MCP1_REGION_A_BASE = 0x3A09
UCC_GLOBAL_RAM_MCP1_REGION_B_BASE = 0x3A0A
UCC_GLOBAL_RAM_MCP1_MEM_REMAP_CTRL = 0x3A0B

def LoadProgram(hardReset, loadType, showProgress):
    if not DA.LoadProgramFileEx(elf, hardReset, loadType, showProgress) != 0 :
       print("Failed to load" + elf)

def PreLoadConfig():
    DA.WriteLong(MCP_MEM_REMAP_B_CTRL, 0, MEMTYPE_PERIPH)
    DA.WriteLong(UCC_GLOBAL_RAM_MCP1_REGION_A_BASE, AmemBase << 8, MEMTYPE_PERIPH)
    DA.WriteLong(UCC_GLOBAL_RAM_MCP1_REGION_B_BASE, BmemBase << 8, MEMTYPE_PERIPH)
    DA.WriteLong(UCC_GLOBAL_RAM_MCP1_REGION_L_BASE, LmemBase << 8, MEMTYPE_PERIPH)
    DA.WriteLong(UCC_GLOBAL_RAM_MCP1_MEM_REMAP_CTRL, 0, MEMTYPE_PERIPH)

def PostLoadConfig():
    pass

def BeforeInit():
    DA.FindTarget('MCP')

def main(hardReset = True, loadType = 0, showProgress = True):
    if hardReset:
        DA.HardReset()
    BeforeInit()
    PreLoadConfig()
    LoadProgram(0, loadType, showProgress)
    PostLoadConfig()

if __name__ == '__main__' :
    main(1,0,1)
