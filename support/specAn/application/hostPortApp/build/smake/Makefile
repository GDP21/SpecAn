
UNIT_TYPE=APP
UNIT_NAME=hostapp
UNIT_OPERATING_SYSTEM=MEOS
UNIT_LDFLAGS+=-Usg

include $(SMAKE_ROOT)/smakeinit.mk

include $(TARGET_SUPPORT_ROOT)/target_support.mk
MODS+=$(PFM_SETUP_ROOT)/platform_setup

C_SRC=main.c

include $(LOCAL_DRIVERS_ROOT)/uccDrivers.mk

# Note that any modules which include MCP code or DCP code will use "late publishing"
# i.e. they won't publish their headers until they're built.  This means placing these things early
# in the MODS list so their headers can be available to other modules.
MODS+=$(ENSIGMA_SDK_ROOT)/log \
     $(UCCLIB_ROOT)/uccRuntime \
	 $(IRQ_GEN_ROOT)/irqGen \
	 $(IMPORTED_DRIVERS_ROOT)/SCP \
	 $(MCPOS_ROOT)/mcpOS \
     $(IP_ROOT)/SPECAN_core \
	 $(TVCORE_ROOT)/tvcore \
	 $(MATHS_FUNCS_ROOT)/maths_funcs \
	 $(AGC_ROOT)/agc \
	 $(UNIT_DIR)/../ufwconfig \
     $(UCC_FRAMEWOK_ROOT)/uccframework \
     $(HOSTAPP_ROOT)/hostmsgproc \
     $(HOSTAPP_ROOT)/hostif

# DCP code is placed at start of GRAM
DCP_ORIGIN=0

# Version numbers are provided in version.mk, auto-generated by the build system.
# Convert from Makefile environment variables to global defines
include ../../../common/build/smake/version.mk
GLOBAL_DEFINES+="VER_MAJ1=$(VER_MAJ1)" \
    "VER_MAJ2=$(VER_MAJ2)" \
    "VER_MAJ3=$(VER_MAJ3)" \
    "VER_BUILD=$(VER_BUILD)"


include $(SMAKE_ROOT)/smake.mk

# extra dependency rule for link script, needs to come after smake.mk has defined $(APP_BIN)
ifdef HOSTAPP_LINK_SCRIPT
UNIT_LDFLAGS+= -T$(HOSTAPP_LINK_SCRIPT)
$(APP_BIN): $(HOSTAPP_LINK_SCRIPT)
endif
